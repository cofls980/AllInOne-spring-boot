<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.hongik.pcrc.allinone.cafe_map.infrastructure.persistance.mysql.repository.CafeMapMapperRepository">

    <!-- cafe_map_cafe -->
    <select id="isExistedCafe" resultType="boolean">
        select exists (select * from cafe_map_cafe where cafe_id = #{cafe_id}) as success
    </select>

    <select id="getListByCafeName" resultType="map">
        select * from cafe_map_cafe where cafe_name like CONCAT('%', #{cafe_name}, '%')
    </select>

    <select id="getListByRegion" resultType="map">
        select * from cafe_map_cafe where province = #{province} and city = #{city}
    </select>

    <select id="getListByCafeNameAndRegion" resultType="map">
        select distinct c.cafe_id, c.cafe_name, c.cafe_branch, c.road_addr, c.floor_info, c.latitude, c.longitude
        from cafe_map_cafe c, cafe_map_region r
        where c.cafe_name like CONCAT('%', #{cafe_name}, '%') and (r.province = #{province} and r.city = #{city} and r.province = c.province and r.city = c.city)
    </select>

    <!-- cafe_map_region -->
    <select id="getRegionInfo" resultType="map">
        select * from cafe_map_region
    </select>

    <!-- cafe_map_category -->
    <select id="getCategoryInfo" resultType="hashmap">
        select sum(경치좋은) as 경치좋은, sum(공부맛집) as 공부맛집, sum(데이트코스) as 데이트코스, sum(드라이브) as 드라이브, sum(디저트맛집) as 디저트맛집, sum(소개팅) as 소개팅,
        sum(인스타감성) as 인스타감성, sum(조용한) as 조용한, sum(커피맛집) as 커피맛집, sum(큰규모) as 큰규모, sum(테마있는) as 테마있는, sum(테이크아웃) as 테이크아웃
        from cafe_map_category
    </select>

    <select id="get" resultType="Integer">
        select #{column} from cafe_map_category
    </select>

</mapper>